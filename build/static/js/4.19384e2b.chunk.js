(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{583:function(e,t,a){"use strict";a.r(t);var n=a(45),r=a(55),l=a(57),s=a(56),o=a(58),i=a(0),c=a.n(i),u=a(576),d=a(60),p=a.n(d),m=a(12),h=a.n(m),v=a(8),y=a.n(v),f=a(9),g=a.n(f),b=a(10),P=a.n(b),G=a(7),k=a.n(G),x=a(11),E=a.n(x),C=a(1),I=a.n(C),w=a(2),D=a.n(w),O=a(16),j=a.n(O),B=a(21),V=a.n(B),A=a(6),M=a.n(A),N=(a(5),a(100)),z=a(101),W=a(204),_=a(318),S=a(261),T=a(560),K=a(3),F=a.n(K),H=a(4),J=a.n(H),R=a(20),U=a(13),q=a(111),L=a(558);function Q(e){var t=e.active,a=e.children,n=e.className,r=e.content,l=e.loading,s=J()(Object(R.a)(t,"active"),Object(R.a)(l,"loading"),"tab",n),o=Object(N.a)(Q,e),i=Object(z.a)(Q,e),u={};return i===L.a&&(u.attached="bottom"),c.a.createElement(i,F()({},u,o,{className:s}),U.b.isNil(a)?r:a)}Q.handledProps=["active","as","children","className","content","loading"],Q.defaultProps={as:L.a,active:!0},Q.propTypes={},Q.create=Object(q.e)(Q,function(e){return{content:e}});var X=Q,Y=function(e){function t(){var e,a;y()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return a=P()(this,(e=k()(t)).call.apply(e,[this].concat(r))),D()(I()(I()(a)),"handleItemClick",function(e,t){var n=t.index;M()(a.props,"onTabChange",e,h()({},a.props,{activeIndex:n})),a.trySetState({activeIndex:n})}),a}return E()(t,e),g()(t,[{key:"getInitialAutoControlledState",value:function(){return{activeIndex:0}}},{key:"renderItems",value:function(){var e=this.props,t=e.panes,a=e.renderActiveOnly,n=this.state.activeIndex;return a?M()(V()(t,"[".concat(n,"]")),"render",this.props):j()(t,function(e,t){var a=e.pane;return X.create(a,{overrideProps:{active:t===n}})})}},{key:"renderMenu",value:function(){var e=this.props,t=e.menu,a=e.panes,n=e.menuPosition,r=this.state.activeIndex;return!0===t.tabular&&"right"===n&&(t.tabular="right"),T.a.create(t,{autoGenerateKey:!1,overrideProps:{items:j()(a,"menuItem"),onItemClick:this.handleItemClick,activeIndex:r}})}},{key:"renderVertical",value:function(e){var t=this.props,a=t.grid,n=t.menuPosition,r=a.paneWidth,l=a.tabWidth,s=p()(a,["paneWidth","tabWidth"]),o=n||"right"===e.props.tabular&&"right"||"left";return c.a.createElement(_.a,s,"left"===o&&S.a.create({width:l,children:e},{autoGenerateKey:!1}),S.a.create({width:r,children:this.renderItems(),stretched:!0},{autoGenerateKey:!1}),"right"===o&&S.a.create({width:l,children:e},{autoGenerateKey:!1}))}},{key:"render",value:function(){var e=this.renderMenu(),a=Object(N.a)(t,this.props),n=Object(z.a)(t,this.props);return e.props.vertical?c.a.createElement(n,a,this.renderVertical(e)):c.a.createElement(n,a,"bottom"!==e.props.attached&&e,this.renderItems(),"bottom"===e.props.attached&&e)}}]),t}(W.a);D()(Y,"autoControlledProps",["activeIndex"]),D()(Y,"defaultProps",{grid:{paneWidth:12,tabWidth:4},menu:{attached:!0,tabular:!0},renderActiveOnly:!0}),D()(Y,"Pane",X),D()(Y,"handledProps",["activeIndex","as","defaultActiveIndex","grid","menu","menuPosition","onTabChange","panes","renderActiveOnly"]),Y.propTypes={};var Z=Y,$=a(38),ee=a.n($),te=a(578),ae=a.n(te),ne=a(158),re={activeGene:"",clusters:{}},le=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state=re,a.renderPlotHeader=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=a.props.modulesData.activeGene;return c.a.createElement(u.a,{as:"h4",icon:!0,textAlign:"center"},c.a.createElement(u.a.Content,null,e," plot - ",t," expression of gene: ",n))},a.renderViolinPlot=function(){return c.a.createElement(c.a.Fragment,null,a.renderPlotHeader("Violin","Top 500 cells per cluster: "),c.a.createElement(ae.a,{className:"full-size large",data:a.createViolinDataPoints(),layout:{height:600,hovermode:"closest",yaxis:{range:[0,6],zeroline:!1},xaxis:{showline:!0,zeroline:!0}}}))},a.createViolinDataPoints=function(){if(a.props.modulesData.cellsByGene.cells.length<1)return"No data registered for this gene.";var e=["grey","green","blue","yellow","purple","brown","pink","orange","red","dark grey","violet","salmon","tomato","khaki","lavender","slateblue","lime","darkcyan"],t=[],n=ee.a.groupBy(a.props.modulesData.cellsByGene.cells,"cluster_id");return Object.keys(n).forEach(function(r){var l={y:ee.a.map(n[r],"CPM"),name:a.state.clusters[r],type:"violin",opacity:.5,meanline:{visible:!0},box:{visible:!0},boxpoints:!0,line:{color:"black"},showlegend:!1,fillcolor:e[r]};t.push(l)}),t},a.createGeneDataPoints=function(){var e=ee.a.map(a.props.modulesData.cellsByGene.cells,function(e){return"Cluster ".concat(e.cluster_id,", Cell type: ").concat(a.state.clusters[e.cluster_id])});return[{x:ee.a.map(a.props.modulesData.cellsByGene.cells,"tsne_1"),y:ee.a.map(a.props.modulesData.cellsByGene.cells,"tsne_2"),text:e,customdata:ee.a.map(a.props.modulesData.cellsByGene.cells,"CPM"),mode:"markers",type:"scattergl",marker:{color:ee.a.map(a.props.modulesData.cellsByGene.cells,"CPM"),colorbar:{title:"CPM",thicknessmode:"fraction",lenmode:"fraction",len:.5,thickness:.01}},hovertemplate:"<b>%{text}</b><br><br> CPM:  %{customdata} <extra></extra>",opacity:.5}]},a.renderGenePlot=function(){return a.state.selected&&ee.a.isEmpty(a.props.modulesData.cellsByGene)?ne.a:a.props.modulesData.cellsByGene.cells.length<1?"No data registered for this gene.":c.a.createElement(c.a.Fragment,null,a.renderPlotHeader("Cluster"),c.a.createElement(ae.a,{className:"full-size large",data:a.createGeneDataPoints(),layout:{height:600,hovermode:"closest",yaxis:{title:"test",showgrid:!1,zeroline:!1},xaxis:{title:"test",showgrid:!1,zeroline:!1}}}))},a.panes=[{menuItem:"Cluster",render:function(){return c.a.createElement(Z.Pane,{attached:!1},a.renderGenePlot())}},{menuItem:"Violin",render:function(){return c.a.createElement(Z.Pane,{attached:!1},a.renderViolinPlot())}}],a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"shouldComponentUpdate",value:function(e,t,a){return!!ee.a.isEmpty(this.props.modulesData.cellsByGene)||t.activeGene!==this.state.activeGene}},{key:"componentDidMount",value:function(){ee.a.isEmpty(this.state.clusters)&&this.setState({clusters:ee.a.mapValues(ee.a.keyBy(ee.a.values(this.props.collection),"cluster_id"),"annotation")})}},{key:"render",value:function(){var e=this.props.modulesData.activeGene;return e!==this.state.activeGene&&this.setState({activeGene:e}),ee.a.isEmpty(this.props.modulesData.cellsByGene)?null:c.a.createElement(c.a.Fragment,null,c.a.createElement(_.a.Row,{centered:!0},c.a.createElement(_.a.Column,null,c.a.createElement(Z,{menu:{secondary:!0,pointing:!0},panes:this.panes}))))}}]),t}(i.Component);t.default=le}}]);
//# sourceMappingURL=4.19384e2b.chunk.js.map