{"version":3,"sources":["components/modules/ClusterViewer/items/GeneralCluster.js"],"names":["initialState","dataReady","clusters","dataset","GeneralCluser","state","createDataPoints","plotTraces","_","groupBy","_this","props","modulesData","cells","Object","keys","forEach","key","name","trace","x","map","y","mode","type","text","hovertemplate","concat","opacity","push","renderGenePlot","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","Fragment","react_plotly_js__WEBPACK_IMPORTED_MODULE_8___default","className","data","layout","height","hovermode","yaxis","title","showgrid","zeroline","xaxis","nextProps","nextState","nextContext","this","ds","console","log","isEmpty","setState","mapValues","keyBy","values","collection","length","_hooks_pageLoader__WEBPACK_IMPORTED_MODULE_10__","frame","semantic_ui_react__WEBPACK_IMPORTED_MODULE_6__","Row","Column","width","semantic_ui_react__WEBPACK_IMPORTED_MODULE_7__","Component"],"mappings":"2NAMMA,EAAe,CAACC,WAAW,EAAOC,SAAU,GAAIC,QAAS,IAEzDC,6MAEFC,MAAQL,IAORM,iBAAmB,WACf,IAAMC,EAAa,GACbL,EAAWM,IAAEC,QAAQC,EAAKC,MAAMC,YAAYC,MAAO,cAezD,OAdAC,OAAOC,KAAKb,GAAUc,QAAQ,SAACC,GAC3B,IAAMC,EAAMR,EAAKL,MAAMH,SAASe,GAC1BE,EAAQ,CACVC,EAAGZ,IAAEa,IAAInB,EAASe,GAAM,UACxBK,EAAGd,IAAEa,IAAInB,EAASe,GAAM,UACxBM,KAAM,UACNC,KAAM,YACNN,KAAMA,EACNO,KAAMjB,IAAEa,IAAInB,EAASe,GAAM,cAC3BS,cAAa,kCAAAC,OAAoCT,EAApC,wBACbU,QAAS,IAEbrB,EAAWsB,KAAKV,KAEbZ,KAEXuB,eAAiB,WACb,OACIC,EAAAC,EAAAC,cAAAF,EAAAC,EAAAE,SAAA,KACIH,EAAAC,EAAAC,cAACE,EAAAH,EAAD,CACII,UAAW,kBACXC,KAAM3B,EAAKJ,mBACXgC,OAAQ,CACJC,OAAQ,IACRC,UAAW,UACXC,MAAO,CACHC,MAAO,OACPC,UAAU,EACVC,UAAU,GAEdC,MAAO,CACHH,MAAO,OACPC,UAAU,EACVC,UAAU,6FAzCZE,EAAWC,EAAWC,GACxC,OAAGC,KAAK5C,MAAM6C,KAAOD,KAAKtC,MAAMR,UACvB8C,KAAK5C,MAAMJ,WAAa8C,EAAU9C,2CAuD3C,OARAkD,QAAQC,IAAIH,KAAKtC,MAAMC,YAAYC,QAC/BL,IAAE6C,QAAQJ,KAAK5C,MAAMH,WAAa+C,KAAK5C,MAAM6C,KAAOD,KAAKtC,MAAMR,WAC/D8C,KAAKK,SAAS,CACVpD,SACIM,IAAE+C,UAAU/C,IAAEgD,MAAMhD,IAAEiD,OAAOR,KAAKtC,MAAM+C,YAAa,cAAe,gBAE5ET,KAAKK,SAAS,CAACJ,GAAID,KAAKtC,MAAMR,WAE9B8C,KAAKtC,MAAMC,YAAYC,MAAM8C,OAAS,EAAU5B,EAAAC,EAAAC,cAAC2B,EAAA,EAAD,CAAYC,OAAO,KAClEZ,KAAK5C,MAAMJ,WAAWgD,KAAKK,SAAS,CAACrD,WAAW,IAEjD8B,EAAAC,EAAAC,cAAAF,EAAAC,EAAAE,SAAA,KACIH,EAAAC,EAAAC,cAAC6B,EAAA,EAAKC,IAAN,KACIhC,EAAAC,EAAAC,cAAC6B,EAAA,EAAKE,OAAN,CAAaC,MAAO,IAChBlC,EAAAC,EAAAC,cAACiC,EAAA,EAAD,KACKjB,KAAKnB,6BApENqC,aA6Eb/D","file":"static/js/4.d9683188.chunk.js","sourcesContent":["import React, {Component} from 'react'\nimport {Grid, Segment,} from 'semantic-ui-react'\nimport Plot from 'react-plotly.js';\nimport _ from 'lodash'\nimport PageLoader from \"../../../hooks/pageLoader\";\n\nconst initialState = {dataReady: false, clusters: {}, dataset: ''}\n\nclass GeneralCluser extends Component {\n\n    state = initialState;\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        if(this.state.ds !== this.props.dataset) return true;\n        return (!this.state.dataReady && nextState.dataReady)\n    }\n\n    createDataPoints = () => {\n        const plotTraces = [];\n        const clusters = _.groupBy(this.props.modulesData.cells, 'cluster_id')\n        Object.keys(clusters).forEach((key) => {\n            const name =this.state.clusters[key]\n            const trace = {\n                x: _.map(clusters[key], 'tsne_1'),\n                y: _.map(clusters[key], 'tsne_2'),\n                mode: 'markers',\n                type: 'scattergl',\n                name: name,\n                text: _.map(clusters[key], 'cluster_id'),\n                hovertemplate: `<b>Cluster %{text}, Cell type: ${name}</b> <extra></extra>`,\n                opacity: 0.5,\n            };\n            plotTraces.push(trace)\n        });\n        return plotTraces\n    }\n    renderGenePlot = () => {\n        return (\n            <>\n                <Plot\n                    className={'full-size large'}\n                    data={this.createDataPoints()}\n                    layout={{\n                        height: 600,\n                        hovermode: 'closest',\n                        yaxis: {\n                            title: \"test\",\n                            showgrid: false,\n                            zeroline: false,\n                        },\n                        xaxis: {\n                            title: \"test\",\n                            showgrid: false,\n                            zeroline: false,\n                        }\n                    }}\n                />\n            </>\n        )\n    }\n    render() {\n        console.log(this.props.modulesData.cells)\n        if (_.isEmpty(this.state.clusters) || this.state.ds !== this.props.dataset){\n            this.setState({\n                clusters:\n                    _.mapValues(_.keyBy(_.values(this.props.collection), 'cluster_id'), 'annotation')\n            })\n            this.setState({ds: this.props.dataset})\n        }\n        if (this.props.modulesData.cells.length < 1) return <PageLoader frame={true} />\n        if (!this.state.dataReady) this.setState({dataReady: true})\n        return (\n            <>\n                <Grid.Row>\n                    <Grid.Column width={16}>\n                        <Segment>\n                            {this.renderGenePlot()}\n                        </Segment>\n                    </Grid.Column>\n                </Grid.Row>\n            </>\n        )\n    }\n}\n\nexport default GeneralCluser\n"],"sourceRoot":""}